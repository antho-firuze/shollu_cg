!function(t,e,a,i){"use strict";var n="shollu_cg",r="1.0.1",o={source:function(t,e){},onSelect:function(t){},onChange:function(t){},style:"bs3",menu_type:"normal",emptyMessage:"<center><b>No results were found</b></center>",page:1,rows:50,idField:"id",textField:"name",queryParams:{},item_cls:"",addition:{},list:{},remote:!1},l=function(e,a){function o(){return"xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(t){var e=16*Math.random()|0,a="x"===t?e:3&e|8;return a.toString(16)})}function l(){return"bs3"==j.style?t('<div class="shollu_cg-container"><div class="input-group"><input type="hidden"><div class="input-group-btn"><span class="btn btn-default shollu_cg dropdown-toggle" data-dropdown="dropdown"><span class="caret" /></span></div></div></div>'):void 0}function s(){return t('<ul class="typeahead-long shollu_cg dropdown-menu dropdown-menu-right" />')}function d(){if(!O.data("init-shollu_cg")){O.data("init-shollu_cg",!0),O.before(P),S.before(O),S.attr("name",O.attr("name")),O.removeAttr("name"),j.disable=O.attr("disabled")===i?!1:O.attr("disabled")?!0:!1,u(j.disable),j.remote||Object.keys(j.list).length>0&&(t.each(j.list,function(t){var e=j.list[t][j.idField];j.list[t][j.textField];$[e]=j.list[t]}),j.rowData=$);var e=O.val();b(e)}return this}function c(){O.data("init-shollu_cg")&&(O.data("init-shollu_cg",!1),O.insertBefore(P),O.attr("name",S.attr("name")),O.val(S.val()),P.remove(),T(!1))}function u(t){O.prop("disabled",t),q.attr("disabled",t),j.disable=t,T(t?!1:!0)}function g(){var e=t.extend({},O.position(),{height:O[0].offsetHeight});M.insertAfter(O).css({top:e.top+e.height,left:e.left}).show(),j.shown=!0}function f(){M.hide(),t(".dropdown-menu").off("mousedown",function(t){"UL"==t.target.tagName}),j.shown=!1}function v(){N=!1,j.escape||(x(),!j.mousedover&&j.shown&&setTimeout(function(){f(),j.page=1},200))}function h(){j.shown&&f(),j.disable||(j.shown?(f(),O.focus()):p())}function p(){var e=O.attr("data-"+j.idField),a=O.attr("data-"+j.textField),i=O.val();if(i!=a&&(O.attr("value","").attr("data-"+j.idField,"").attr("data-"+j.textField,""),S.val("").trigger("change"),j.onChange.call(this,{}),e=""),j.remote){var n={page:j.page,rows:j.rows};e?n[j.idField]=e:i&&(n.q=i),t.each(j.queryParams,function(t,e){n[t]=e}),setTimeout(function(){t.getJSON(j.url,n,function(t){var e=t.data;Object.keys(e).length>0&&m(e)})},100)}else m(j.list)}function x(){var t=O.attr("data-"+j.idField),e=M.find(".active").data(j.idField),a=(O.attr("data-"+j.textField),M.find(".active").data(j.textField));O.val();return e===i?""!==t?f():(O.attr("value","").attr("data-"+j.idField,"").attr("data-"+j.textField,"").val("").trigger("change"),f()):e==t?f():e!=t&&j.escape?(O.attr("value","").attr("data-"+j.idField,"").attr("data-"+j.textField,"").val("").trigger("change"),M.find(".active").removeClass("active"),j.escape=!1,f()):e==t||j.mousedover?e!=t?(O.attr("value",e).attr("data-"+j.idField,e).attr("data-"+j.textField,a).val(a).trigger("change"),S.val(e).trigger("change"),j.onSelect.call(this,j.rowData[e]),f()):void 0:j.tabenter?(O.attr("value",e).attr("data-"+j.idField,e).attr("data-"+j.textField,a).val(a).trigger("change"),S.val(e).trigger("change"),j.onSelect.call(this,j.rowData[e]),j.tabenter=!1,f()):(O.attr("value","").attr("data-"+j.idField,"").attr("data-"+j.textField,"").val("").trigger("change"),M.find(".active").removeClass("active"),f())}function m(e){var a=[],i=e,n=O.attr("data-"+j.idField),r=O.val();if(1==j.page&&M.empty(),Object.keys(j.addition).length>0){var o=j.addition[j.idField],l=j.addition[j.textField],s=j.item_cls?'class="'+j.item_cls+'" ':"";a.push(t("<li "+s+"data-"+j.idField+'="'+o+'" data-'+j.textField+'="'+l+'"><a>'+l+"</a></li>")),$[o]=j.addition}j.remote&&(i=e.rows,H=Math.ceil(e.total/j.rows)),Object.keys(i).length>0?(t.each(i,function(e){var o=i[e][j.idField],l=i[e][j.textField],s=j.item_cls?'class="'+j.item_cls+'" ':"";if(n&&n==o){var d="active ";s=s?s+d:'class="'+d+'"'}if(r&&r==l.toLowerCase()){var d="active ";s=s?s+d:'class="'+d+'"'}r=r.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&");var c=new RegExp("("+r.split(" ").join("|")+")","gi");a.push(t("<li "+s+"data-"+j.idField+'="'+o+'" data-'+j.textField+'="'+l+'"><a>'+l.replace(c,"<b>$1</b>")+"</a></li>")),$[o]=i[e]}),M.append(a)):M.append('<span style="color:#999;">'+j.emptyMessage+"</span>"),j.rowData=$,g(),O.focus()}function w(){var t=M.find(".active");if(t.length){var e=t.position().top,a=e+t.height(),i=M.scrollTop(),n=M.height();a>n?M.scrollTop(i+a-n):0>e&&M.scrollTop(i+e)}}function F(t){var e;return t=t===i?j.idField:t,(e=O.attr("value")===i?"":""==O.attr("value")?"":O.attr("value"))&&O.attr("value")?(e=j.rowData[O.attr("value")][t])===i?!1:e:void 0}function b(e){if(O.data("init-shollu_cg")!==!1){if(!e||0>e)return O.attr("value","").attr("data-"+j.idField,"").attr("data-"+j.textField,"").val("").trigger("change"),S.val("").trigger("change"),void j.onChange.call(this,{});if(j.remote)setTimeout(function(){t.getJSON(j.url,{id:e},function(t){var e=t.data.rows[0];if("undefined"!=typeof e){var a=e[j.idField],i=e[j.textField];O.attr("value",a).attr("data-"+j.idField,a).attr("data-"+j.textField,i).val(i).trigger("change"),S.val(a).trigger("change"),j.selected=!0,$[a]=e,j.rowData=$,j.onChange.call(this,j.rowData[a])}})},100);else if(Object.keys(j.list).length>0&&j.rowData[e]!==i){var a=j.rowData[e][j.idField],n=j.rowData[e][j.textField];O.attr("value",a).attr("data-"+j.idField,a).attr("data-"+j.textField,n).val(n).trigger("change"),S.val(a).trigger("change"),j.selected=!0,j.onChange.call(this,j.rowData[a])}}}function y(e){O.focus(),e.stopPropagation(),e.preventDefault();var a=(e.currentTarget.scrollTop+t(e.currentTarget).height())/e.currentTarget.scrollHeight*100;if(a>90&&!J&&j.page<H&&(J=!0,j.page++,j.remote)){var i=O.val(),n={q:i,page:j.page,rows:j.rows};t.each(j.queryParams,function(t,e){n[t]=e}),setTimeout(function(){t.getJSON(j.url,n,function(t){var e=t.data;Object.keys(e).length>0&&m(e),J=!1})},100)}}function k(){var e=M.find(".active").removeClass("active"),a=e.next();a.length||(a=t(M.find("li")[0])),a.addClass("active")}function _(){var t=M.find(".active").removeClass("active"),e=t.prev();e.length||(e=M.find("li").last()),e.addClass("active")}function C(t){if(j.shown){switch(t.keyCode){case 9:case 13:case 27:t.preventDefault();break;case 38:t.preventDefault(),_(),w();break;case 40:t.preventDefault(),k(),w()}t.stopPropagation()}}function D(t){switch(t.keyCode){case 40:j.shown||h();break;case 39:case 38:case 37:case 36:case 35:case 16:case 17:case 18:break;case 9:case 13:if(!j.shown)return;j.tabenter=!0,x();break;case 27:if(!j.shown)return;j.escape=!0,x();break;default:p()}t.stopPropagation(),t.preventDefault()}function T(e){e?(O.on("focus",function(){N=!0}).on("blur",v).on("keypress",function(t){A||C(t)}).on("keydown",function(e){A=~t.inArray(e.keyCode,[40,38,9,13,27]),C(e)}).on("keyup",D).on("dblclick",h),M.on("click",function(t){O.focus(),t.stopPropagation(),t.preventDefault(),x()}).on("mouseenter","li",function(e){j.mousedover=!0,M.find(".active").removeClass("active"),t(e.currentTarget).addClass("active")}).on("mouseleave",function(){j.mousedover=!1}).scroll(y),q.on("click",h)):(O.off("blur focusout focus keydown keyup keypress dblclick"),M.off("click mouseenter mouseleave scroll"),q.off("click"))}var j=a;j.guid=o();var O=t(e),P=l(),S=P.find("input[type=hidden]"),q=P.find("span.shollu_cg.dropdown-toggle"),M=s(),N=!1,A={},J=!1,$={},H=1;j.escape=!1,j.tabenter=!1,this.name=n,this.version=r+" ("+j.guid+")",this.guid=j.guid,this.o=j,this.destroy=function(){c()},this.getValue=function(t){return F(t)},this.setValue=function(t){b(t)},this.disable=function(t){u(t)},this.init=function(){d()},d()};t.fn.shollu_cg=function(e){var a=t(this),i=a.data("shollu_cg");if("string"==typeof e){if(!i)return this;if(i[e])return t.isFunction(i[e])?i[e].apply(i,Array.prototype.slice.call(arguments,1)):i[e];t.error("Method "+e+" does not exist on jQuery.shollu_cg")}return this.each(function(){i?(i.o=t.extend(i.o,e),a.data("shollu_cg",i)):a.data("shollu_cg",new l(this,t.extend({},o,e)))})}}(jQuery);